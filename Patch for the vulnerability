<?php
    if (isset($_GET['host'])) {
        $host = $_GET['host'];
        // Use regular expression to ensure input only contains valid characters
        if (preg_match('/^[a-zA-Z0-9\-\.]+$/', $host)) {
            // Use a whitelist approach to only allow known safe characters
            $host = escapeshellarg($host);
            $output = shell_exec('ping -c 4 ' . $host);
            echo "<pre>$output</pre>";
        } else {
            echo "Invalid input";
        }
    }
?>
<html>
    <body>
        <form action="" method="GET">
            <label for="host">Enter a hostname or IP address to ping:</label><br>
            <input type="text" id="host" name="host"><br>
            <input type="submit" value="Submit">
        </form>
    </body>
</html>
